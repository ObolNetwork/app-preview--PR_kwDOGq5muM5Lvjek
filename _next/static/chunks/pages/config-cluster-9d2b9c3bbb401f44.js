(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{40168:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/config-cluster",function(){return r(40309)}])},40309:function(e,s,r){"use strict";r.r(s);var n=r(85893),i=r(67294),t=r(87536),o=r(25934),c=r(71553),l=r(93445),a=r(16960),d=r(72534),u=r(37274),x=r(11163),h=r(23691),p=r(8507),m=r(48847),v=r(76225),g=r(25089);function f(e,s,r){return s in e?Object.defineProperty(e,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[s]=r,e}function j(e){for(var s=1;s<arguments.length;s++){var r=null!=arguments[s]?arguments[s]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(s){f(e,s,r[s])}))}return e}var b=function(){var e,s,r,f,b,C,y,k,$=(0,u.o)((function(e){return e.clusterDefinition})),w=(0,t.cI)({mode:"onChange",defaultValues:{operators:h.fI,recipients:h.Ot,singleAddress:"",feeRecipientAddress:"",principal:"",enr:"",name:""}}),A=w.control,_=w.register,S=w.handleSubmit,R=w.formState,T=R.errors,E=R.isDirty,N=R.isValid,O=w.resetField,I=w.setValue,z=w.trigger,V=w.getValues,D=(0,t.Dq)({control:A,name:"operators"}),F=D.fields,P=D.append,W=D.remove,Z=(0,t.Dq)({control:A,name:"recipients"}),q=Z.fields,K=Z.append,G=Z.remove,Q=(0,x.useRouter)(),U=(0,u.o)((function(e){return e.completeLeaderStep})),H=(0,u.o)((function(e){return e.enableLeaderStep})),L=(0,u.o)((function(e){return e.updateClusterDefinition})),J=(0,i.useState)(100),M=J[0],X=J[1],B=(0,d.kR)(),Y=B.account,ee=(B.provider,(0,d.pZ)(Y)),se=(0,i.useState)(!!(0,g.c)("non_operator_flow")&&(null===$||void 0===$?void 0:$.nonOperatorFlag)),re=se[0],ne=se[1],ie=(0,d.D9)(re),te=(0,i.useState)((null===$||void 0===$?void 0:$.clusterSize)||4),oe=te[0],ce=te[1],le=(0,d.D9)(oe),ae=(0,i.useState)((null===$||void 0===$?void 0:$.validatorsSize)||1),de=ae[0],ue=ae[1],xe=(0,i.useState)((function(){return(0,g.c)("single_reward_address_flow")?"single":"splitter"})),he=xe[0],pe=xe[1],me=(0,i.useState)([{id:(0,o.Z)(),operator:null,principal:32}]),ve=me[0],ge=(me[1],(0,i.useState)()),fe=ge[0],je=ge[1],be=(0,i.useState)(),Ce=be[0],ye=be[1];return(0,i.useEffect)((function(){he&&O("singleAddress")}),[he]),(0,i.useEffect)((function(){de&&je(32*de)}),[de]),(0,i.useEffect)((function(){if(oe){var e=(0,m.zT)(oe);ye(e)}le&&le<oe&&P({address:""},{shouldFocus:!1}),le&&le>oe&&W(oe-1)}),[le,oe]),(0,i.useEffect)((function(){(0,g.c)("non_operator_flow")&&(re&&P({address:""},{shouldFocus:!1}),1!=ie||re||W(V().operators.length-1))}),[re]),(0,i.useEffect)((function(){I("singleAddress",null===$||void 0===$?void 0:$.singleAddress),I("feeRecipientAddress",null===$||void 0===$?void 0:$.feeRecipientAddress),I("enr",null===$||void 0===$?void 0:$.enr),I("name",null===$||void 0===$?void 0:$.name),I("principal",null===$||void 0===$?void 0:$.principal),(null===$||void 0===$?void 0:$.operators)&&I("operators",null===$||void 0===$?void 0:$.operators),(null===$||void 0===$?void 0:$.recipients)&&I("recipients",null===$||void 0===$?void 0:$.recipients)}),[]),(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,n.jsx)(c.xv,{variant:"h3",children:"Configure Cluster"}),(0,n.jsx)(l.l0,{onSubmit:S((function(e){U("config-cluster"),L(j({},e,{creator:{address:Y},validatorsEthAmount:fe,validators:new Array(de).fill({feeRecipientAddress:e.feeRecipientAddress,withdrawalAddress:e.singleAddress}),nonOperatorFlag:re}));var s=H("confirm-configuration");Q.push(s.href)})),children:(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,n.jsx)(c.W2,{className:"cluster-details",alignItems:"start",children:(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,n.jsx)(c.xv,{variant:"h4",children:"Cluster Details"}),(0,n.jsxs)(l.kC,{direction:"column",className:"cluster-name-section",css:{gap:"$sm"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Cluster Name"}),(0,n.jsx)(c.xv,{variant:"metadata",color:"muted",children:"Used to identify your group during configuration process"}),(0,n.jsx)(c.nv,j({},_("name",{required:!0}),{placeholder:"Super Validators",defaultValue:null===$||void 0===$?void 0:$.name}))]}),(0,n.jsxs)(l.kC,{direction:{"@sm":"column"},className:"cluster-size-section",css:{gap:"$3xl"},children:[(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$sm",width:"auto"},children:[(0,n.jsxs)(l.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Cluster Size"}),(0,n.jsx)(c.KZ,{content:"Cluster Size: The number of operators in the cluster. The minimum is 4, for now the maximum is capped at 10.",children:(0,n.jsx)(c.xu,{css:{display:"flex"},children:(0,n.jsx)(c.by,{})})})]}),(0,n.jsx)(a.fx,{name:"clusterSize",value:oe,control:A,onChangeValue:function(e){return ce(e)},min:4})]}),(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$sm",width:"auto"},children:[(0,n.jsxs)(l.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Threshold"}),(0,n.jsx)(c.KZ,{content:"Threshold: The number of nodes that need to be functioning for the validator to stay active.",children:(0,n.jsx)(c.xu,{css:{display:"flex"},children:(0,n.jsx)(c.by,{})})})]}),(0,n.jsx)(l.kC,{css:{height:"100%",alignItems:"center"},children:(0,n.jsx)(c.xv,{variant:"h5",css:{color:"$body"},children:"".concat(Ce,"/").concat(oe)})})]}),(0,n.jsx)(g.T,{name:"non_operator_flow",children:(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$sm",width:"auto"},children:[(0,n.jsxs)(l.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Non operator"}),(0,n.jsx)(c.KZ,{content:"A flag to indicate you are not an operator in the cluster.",children:(0,n.jsx)(c.xu,{css:{display:"flex"},children:(0,n.jsx)(c.by,{})})})]}),(0,n.jsx)(l.kC,{css:{height:"100%",alignItems:"center"},children:(0,n.jsx)(c.rs,{checked:re,onCheckedChange:function(){ne(!re)}})})]})})]}),(0,n.jsxs)(l.kC,{direction:"column",className:"operator-address-section",css:{gap:"$sm"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Your Address"}),(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$xxxs"},children:[ee&&(0,n.jsx)(c.xv,{color:"white",children:ee}),(0,n.jsx)(c.xv,{color:"obolGreen",children:Y})]})]}),F.map((function(e,s){var r,i,t;return(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$sm","& div > input":{color:"$obolGreen"}},children:[(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$sm"},children:[(0,n.jsx)(c.xv,{variant:"subline",color:"body",css:{textTransform:"uppercase"},children:"Operator ".concat(re?s+1:s+2)}),(0,n.jsx)(l.kC,{direction:"column",css:{border:"2px solid $bg04",backgroundColor:"$bg03",borderRadius:"$1",px:"$sm",py:"$xs","&:focus-within":{backgroundColor:"$bg02"}},children:(0,n.jsx)(a.l_,{control:A,name:"operators.".concat(s,".address"),items:V().operators,defaultAddress:Y})})]}),(null===(r=T.operators)||void 0===r?void 0:r[s])&&(0,n.jsx)(c.xv,{variant:"metadata",color:"test",children:null===(t=null===(i=T.operators)||void 0===i?void 0:i[s].address)||void 0===t?void 0:t.message})]},":op".concat(e&&e.id,":"))}))]})}),(0,n.jsxs)(c.W2,{className:"validators-section",alignItems:"start",children:[(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{variant:"h4",children:"Validators"}),(0,n.jsx)(c.xv,{size:"4",color:"muted",children:"Select how many Ethereum validators validators you want to run."})]}),(0,n.jsxs)(l.kC,{direction:{"@sm":"column"},css:{gap:"$xl",width:"auto"},children:[(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$xs"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Validators"}),(0,n.jsx)(a.fx,{value:de,onChangeValue:function(e){ue(Number(e))},name:"validatorsSize",control:A,min:1,max:(0,g.c)("multi_withdrawal")||"splitter"!==he?250:1})]}),(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$xs"},children:[(0,n.jsx)(c.xv,{css:{textTransform:"uppercase"},variant:"subline",color:"body",children:"Cost"}),(0,n.jsxs)(l.kC,{css:{gap:"$xxs",height:"100%",alignItems:"center"},children:[(0,n.jsx)(c.Ee,{src:"/assets/eth-icon.svg",alt:"eth",width:24,height:24}),(0,n.jsxs)(c.xv,{css:{textTransform:"uppercase"},variant:"h5",children:[fe," Eth"]})]})]})]})]}),!re&&(0,n.jsxs)(c.W2,{className:"enr-section",alignItems:"start",css:{gap:"$lg"},children:[(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$sm"},children:[(0,n.jsxs)(l.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{variant:"subline",color:"body",css:{textTransform:"uppercase"},children:"What is your Charon Client's ENR?"}),(0,n.jsx)(c.KZ,{content:"An ENR is a public key and encoded networking info starting with enr:-...",children:(0,n.jsx)(c.xu,{css:{display:"flex"},children:(0,n.jsx)(c.by,{})})})]}),(0,n.jsx)(a.iA,{control:A,name:"enr"})]}),(0,n.jsxs)(c.rU,{href:"https://docs.obol.tech/docs/next/int/quickstart/group/quickstart-group-leader-creator#step-2-create-and-back-up-a-private-key-for-charon",target:"_blank",children:["How to generate your ENR ",(0,n.jsx)(c.ZJ,{})]})]}),(0,n.jsxs)(c.W2,{className:"withdrawal-section",css:{gap:"$lg"},alignItems:"start",children:[(0,n.jsx)(c.xv,{variant:"h4",children:"Withdrawal Addesses"}),(0,n.jsx)(c.Hc,{value:he,onValueChange:function(e){return pe(p.RJ[e])},defaultValue:(0,g.c)("single_reward_address_flow")?"single":"splitter","aria-label":"View density",children:(0,n.jsxs)(l.kC,{direction:{"@sm":"column"},css:{width:"$full",gap:"$sm"},children:[(0,n.jsx)(g.T,{name:"single_reward_address_flow",children:(0,n.jsxs)(c.xu,{css:{display:"flex",margin:"10px 0",alignItems:"center"},children:[(0,n.jsx)(c.Wr,{value:"single",id:"r2",children:(0,n.jsx)(c.Q4,{})}),(0,n.jsx)(c.qH,{htmlFor:"r2",css:{fontWeight:"$bold",color:"$light"},children:"Single Address"})]})}),(0,n.jsx)(g.T,{name:"reward_split_withdrawal_flow",children:(0,n.jsxs)(c.xu,{css:{display:"flex",margin:"10px 0",alignItems:"center"},children:[(0,n.jsx)(c.Wr,{value:"splitter",id:"r1",children:(0,n.jsx)(c.Q4,{})}),(0,n.jsx)(c.qH,{htmlFor:"r1",css:{fontWeight:"$bold",color:"$light"},children:"Splitter Contract"})]})})]})}),"splitter"===he?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.xv,{color:"body",variant:"body",children:"Enter each recipient\u2019s address and their share. Ownership must\n                add to 100%."}),(0,n.jsx)(c.xv,{color:"body",variant:"body",children:" By default, a 2% of rewards are allocated to be used by Obol\n                for Public Goods."}),(0,n.jsxs)(l.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{color:"body",variant:"subline",css:{textTransform:"uppercase"},children:"Recipient of Principal"}),(0,n.jsx)(c.KZ,{content:"Address that can claim the first 32 ether of an exited validator",children:(0,n.jsx)(c.xu,{css:{display:"flex"},children:(0,n.jsx)(c.by,{})})})]}),(0,n.jsx)(v.WO,{columns:h.oU,rows:ve,children:(0,n.jsx)(l.kC,{direction:"column",css:{px:"$sm",py:"$xs","&:focus-within":{backgroundColor:"$bg02"}},children:(0,n.jsx)(a.bQ,{control:A,name:"principal"})})}),(null===(e=T.principal)||void 0===e?void 0:e.message)&&(0,n.jsx)(c.xv,{variant:"metadata",color:"test",children:null===(s=T.principal)||void 0===s?void 0:s.message}),(0,n.jsxs)(l.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,n.jsx)(c.xv,{color:"body",variant:"subline",css:{textTransform:"uppercase"},children:"Reward Split"}),(0,n.jsx)(c.KZ,{content:"Address to receive validator rewards at exit (staking, MEV and fees).",children:(0,n.jsx)(c.xu,{css:{display:"flex"},children:(0,n.jsx)(c.by,{})})})]}),(0,n.jsx)(v.Cl,{columns:h.$y,rows:q,onAddRow:function(){K({address:"",split:""})},onRemoveRow:function(e){G(e);var s=V().recipients.reduce((function(e,s){return s.split?parseFloat(s.split)+e:e}),0);X(s)},totalSplitFooter:M,setMaxSplit:X,control:A,recipients:V().recipients}),(null===(r=T.recipients)||void 0===r?void 0:r.some((function(e){var s;return null===e||void 0===e||null===(s=e.address)||void 0===s?void 0:s.message})))&&(0,n.jsx)(c.xv,{variant:"metadata",color:"test",children:"Please enter a valid, non-duplicate Ethereum address or ENS name"}),(null===(f=T.recipients)||void 0===f?void 0:f.some((function(e){var s;return null===e||void 0===e||null===(s=e.split)||void 0===s?void 0:s.message})))&&(0,n.jsx)(c.xv,{variant:"metadata",color:"test",children:"Split value should be greater than 0%"})]}):(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$lg"},children:[(0,n.jsxs)(l.kC,{direction:"column",className:"single-address-section",css:{gap:"$xs"},children:[(0,n.jsx)(c.xv,{variant:"h5",children:"Principal Address"}),(0,n.jsxs)(l.kC,{css:{justifyContent:"space-between"},children:[(0,n.jsx)(c.xv,{color:"body",variant:"body",children:"Address to receive validator principal and rewards at exit"}),(0,n.jsx)(c.zx,{ghost:!0,css:{color:"$obolGreen",fontSize:"$1",p:0,height:"100%"},onClick:function(e){e.preventDefault(),I("singleAddress",Y),z("singleAddress")},children:"Use my address"})]}),(0,n.jsx)(l.kC,{direction:"column",css:{border:"2px solid $bg04",backgroundColor:"$bg03",borderRadius:"$1",px:"$sm",py:"$xs","&:focus-within":{backgroundColor:"$bg02"}},children:(0,n.jsx)(a.bQ,{control:A,name:"singleAddress"})}),(null===(b=T.singleAddress)||void 0===b?void 0:b.message)&&(0,n.jsx)(c.xv,{variant:"metadata",color:"test",children:null===(C=T.singleAddress)||void 0===C?void 0:C.message})]}),(0,n.jsxs)(l.kC,{direction:"column",css:{gap:"$xs"},children:[(0,n.jsx)(c.xv,{variant:"h5",children:"Fee Recipient"}),(0,n.jsxs)(l.kC,{direction:"column",className:"fee-recipient-address-section",css:{gap:"$sm"},children:[(0,n.jsxs)(l.kC,{css:{justifyContent:"space-between"},children:[(0,n.jsx)(c.xv,{color:"body",variant:"body",children:"Address to receive transaction fees from block proposals."}),(0,n.jsx)(c.zx,{ghost:!0,css:{color:"$obolGreen",fontSize:"$1",p:0,height:"100%"},onClick:function(e){e.preventDefault(),I("feeRecipientAddress",Y),z("feeRecipientAddress")},children:"Use my address"})]}),(0,n.jsx)(l.kC,{direction:"column",css:{border:"2px solid $bg04",backgroundColor:"$bg03",borderRadius:"$1",px:"$sm",py:"$xs","&:focus-within":{backgroundColor:"$bg02"}},children:(0,n.jsx)(a.bQ,{control:A,name:"feeRecipientAddress"})}),(null===(y=T.feeRecipientAddress)||void 0===y?void 0:y.message)&&(0,n.jsx)(c.xv,{variant:"metadata",color:"test",children:null===(k=T.feeRecipientAddress)||void 0===k?void 0:k.message})]})]})]})]}),(0,n.jsx)(l.kC,{direction:"column",children:(0,n.jsx)(c.zx,{color:"primary",type:"submit",disabled:!E||0!==Object.keys(T).length||!N||!Y||100!==M,children:"Create Cluster Configuration"})})]})})]})};s.default=b,b.layout="ProgressTrackerLayout"}},function(e){e.O(0,[774,888,179],(function(){return s=40168,e(e.s=s);var s}));var s=e.O();_N_E=s}]);