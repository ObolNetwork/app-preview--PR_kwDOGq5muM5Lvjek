(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{67333:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dv/accept-configuration",function(){return n(11777)}])},24585:function(e,r,n){"use strict";n.d(r,{I:function(){return a}});var t=n(85893),s=n(71553),i=n(84373),o=n(64240),a=function(e){var r=e.recipients,n=(0,i.Z)(r.map((function(e){return e.address})));return(0,t.jsx)(s.iA,{columns:[{accessorKey:"operator",header:"Operator Address"},{accessorKey:"split",header:"Split",css:{width:"70px"}}],rows:r.map((function(e,r){return{operator:(0,t.jsx)(o.M,{ensName:n[r],address:e.address}),split:"".concat(e.split||e.percentAllocation," %")}}))})}},11777:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return S}});var t=n(34051),s=n.n(t),i=n(85893),o=n(93445),a=n(71553),c=n(8687),l=n(23691),d=n(37274),u=n(87536),h=n(72534),x=n(48847),p=n(2983),v=n(11163),f=n(8100),g=n(67294),m=n(79986),j=n(76225),b=n(24585),y=function(e){var r=e.splitId,n=e.recipients;return(0,i.jsxs)(a.W2,{className:"withdrawal-section",css:{gap:"$xl"},alignItems:"start",children:[(0,i.jsx)(a.xv,{variant:"h4",children:"Splitter Reward Addresses"}),(0,i.jsx)(b.I,{recipients:n}),(0,i.jsxs)(a.W2,{variant:"card",className:"enr-section",alignItems:"start",css:{gap:"$sm",p:"$sm"},children:[(0,i.jsx)(a.xv,{color:"body",variant:"subline",css:{lineHeight:"$lg",textTransform:"uppercase",letterSpacing:"1px"},children:"Splitter Address"}),(0,i.jsx)(a.IK,{readOnly:!0,value:r}),(0,i.jsxs)(a.rU,{href:"https://".concat(l.pn,".etherscan.io/address/").concat(r,"#code"),target:"_blank",children:["View on Etherscan ",(0,i.jsx)(a.ZJ,{})]})]})]})},w=n(25089);function $(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function C(e,r,n,t,s,i,o){try{var a=e[i](o),c=a.value}catch(l){return void n(l)}a.done?r(c):Promise.resolve(c).then(t,s)}function _(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,s,i=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(i.push(t.value),!r||i.length!==r);o=!0);}catch(c){a=!0,s=c}finally{try{o||null==n.return||n.return()}finally{if(a)throw s}}return i}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return $(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var k=function(){var e=(0,h.kR)(),r=e.account,n=e.provider,t=e.chainId,b=(0,u.cI)({mode:"onChange"}),$=b.control,k=b.handleSubmit,S=b.formState,N=S.isDirty,I=S.isValid,A=(0,v.useRouter)(),T=(0,g.useState)(!1),W=T[0],E=T[1],R=(0,g.useState)(!1),O=R[0],z=R[1],M=(0,g.useState)(),D=M[0],G=M[1],L=(0,g.useState)(""),P=L[0],Z=L[1],F=(0,d.o)((function(e){return e.clusterDefinitionData})),K=(0,d.o)((function(e){return e.updateJoinFirstStep})),Y=(0,d.o)((function(e){return e.completeOperatorStep})),H=(0,d.o)((function(e){return e.enableOperatorStep}));(null===F||void 0===F?void 0:F.config_hash)&&K("/dv#".concat(null===F||void 0===F?void 0:F.config_hash));var Q=function(){var e,i=(e=s().mark((function e(i){var o,a,c,d,u,h,v,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Z(""),z(!0),o={operator_config_hash:null===F||void 0===F?void 0:F.config_hash},e.next=6,(0,x.AM)(n,t,r,o);case 6:return a=e.sent,c={enr:i.enr},e.next=10,(0,x.Ol)(n,t,r,c);case 10:return d=e.sent,u={address:r,enr:i.enr,enr_signature:d,fork_version:l.se,version:l.q4.STABLE},e.next=14,(0,p.R)({token:a,data:u,configHash:null===F||void 0===F?void 0:F.config_hash});case 14:h=e.sent.data,G(h),z(!1),e.next=25;break;case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0),Z(null===(v=e.t0.response)||void 0===v||null===(f=v.data)||void 0===f?void 0:f.message),z(!1);case 25:case"end":return e.stop()}}),e,null,[[0,19]])})),function(){var r=this,n=arguments;return new Promise((function(t,s){var i=e.apply(r,n);function o(e){C(i,t,s,o,a,"next",e)}function a(e){C(i,t,s,o,a,"throw",e)}o(void 0)}))});return function(e){return i.apply(this,arguments)}}(),U=(0,f.ZP)("/dv/".concat(null===F||void 0===F?void 0:F.config_hash),p.FU,{refreshInterval:function(e){return(null===e||void 0===e?void 0:e.definition_hash)?0:1e3}}).data,V=_(U.validators||[],1)[0],q=(0,w.c)("multi_withdrawal")?null===V||void 0===V?void 0:V.fee_recipient_address:U.fee_recipient_address,J=(0,h.DS)(q);if(console.log("splitMetadata",J),!U)return(0,i.jsx)(a.xv,{children:"Loading..."});var X=U.operators.length,B="".concat("https://dev.launchpad.obol.tech","/dv#").concat(U.config_hash),ee=function(){return(0,i.jsx)(a.W2,{className:"cluster-details",alignItems:"start",children:(0,i.jsxs)(o.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,i.jsx)(a.xv,{variant:"h4",children:"Cluster Details"}),(0,i.jsxs)(o.kC,{direction:"column",className:"cluster-name-section",css:{gap:"$sm"},children:[(0,i.jsx)(a.xv,{color:"body",variant:"body",children:"These are the group details that you need to review and accept to continue.\xa0"}),(0,i.jsx)(a.xv,{color:"body",variant:"body",children:"The status of each participant will update once they have signed and confirmed the configuration."}),(0,i.jsxs)(o.kC,{css:{gap:"$2xl"},children:[(0,i.jsx)(c.Mz,{heading:"Cluster Name",subHeading:U.name}),(0,i.jsx)(c.Mz,{heading:"Group Size",subHeading:X.toString(),tooltipContent:"Group Size: The number of operators in the cluster. The minimum is 4, for now the maximum is capped at 10."}),(0,i.jsx)(c.Mz,{heading:"Threshold",subHeading:"".concat(U.threshold,"/").concat(X),tooltipContent:"Threshold: The number of nodes that need to be functioning for the validator to stay active."})]}),(0,i.jsx)(j.SS,{operators:null===U||void 0===U?void 0:U.operators})]})]})})},re=function(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.kC,{css:{backgroundColor:"$bg03",borderRadius:"$1",gap:"$xs",p:"$sm",boxSizing:"border-box",width:"$full"},children:[(0,i.jsx)(a.xu,{children:(0,i.jsx)(a.nQ,{})}),(0,i.jsx)(a.xv,{variant:"body",css:{fontWeight:"$bold",color:"$light"},children:"Confirmation signature successfully submitted"})]}),(0,i.jsxs)(o.kC,{css:{backgroundColor:"$bg03",borderRadius:"$1",gap:"$xs",p:"$sm",boxSizing:"border-box",width:"$full"},children:[(0,x.YC)(null===U||void 0===U?void 0:U.operators)?(0,i.jsx)(a.xu,{children:(0,i.jsx)(a.nQ,{})}):(0,i.jsx)(a.xu,{children:(0,i.jsx)(a.ZG,{})}),(0,i.jsx)(o.kC,{css:{fd:"column",gap:"$xs"},children:(0,i.jsx)(a.xv,{variant:"body",css:{fontWeight:"$bold",color:"$light"},children:"Awaiting all group signatures to proceed to Distributed Key Generation."})})]}),(0,i.jsx)(c.DM,{heading:"Group Invite Link",content:B})]})},ne=function(){return(0,i.jsxs)(o.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,i.jsx)(a.xv,{variant:"h3",children:"Accept Configuration"}),(0,i.jsx)(c.qN,{}),(0,i.jsx)(a.W2,{className:"success-section",alignItems:"start",css:{gap:"$xs"},children:(0,i.jsxs)(o.kC,{css:{backgroundColor:"$bg03",borderRadius:"$1",gap:"$xs",p:"$sm",boxSizing:"border-box",width:"$full"},children:[(0,i.jsx)(a.xu,{children:(0,i.jsx)(a.nQ,{})}),(0,i.jsx)(a.xv,{variant:"body",css:{fontWeight:"$bold",color:"$light"},children:"All operators can now proceed to the Distributed Key Generation phase"})]})}),(0,i.jsx)(a.W2,{children:(0,i.jsx)(a.zx,{fullWidth:!0,onClick:function(){return function(){Y("dv-accept-config");var e=H("dv-dkg");A.push(e.href)}()},children:"Continue"})})]})};if((0,x.YC)(null===U||void 0===U?void 0:U.operators)&&(null===U||void 0===U?void 0:U.definition_hash))return(0,i.jsx)(ne,{});var te=U.operators.find((function(e){var n;return(null===e||void 0===e||null===(n=e.address)||void 0===n?void 0:n.toLowerCase())===(null===r||void 0===r?void 0:r.toLowerCase())}));(0,x._h)(te)&&!D&&G(te);var se=function(){return(0,i.jsx)(w.T,{name:"reward_split_withdrawal_flow",children:(null===J||void 0===J?void 0:J.recipients)&&(0,i.jsx)(y,{recipients:null===J||void 0===J?void 0:J.recipients,splitId:q})})};return(0,i.jsxs)(o.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,i.jsx)(a.xv,{variant:"h3",children:D?"Waiting for all participants to accept configuration":"Accept Configuration"}),(0,i.jsx)(o.l0,{onSubmit:k(Q),children:(0,i.jsxs)(o.kC,{direction:"column",css:{gap:"$2xl"},children:[(0,i.jsx)(ee,{}),(0,i.jsx)(se,{}),D?(0,i.jsx)(a.W2,{className:"waiting-section",alignItems:"start",css:{gap:"$lg"},children:(0,i.jsx)(re,{})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.W2,{className:"enr-section",alignItems:"start",css:{gap:"$lg"},children:[(0,i.jsxs)(o.kC,{direction:"column",css:{gap:"$sm"},children:[(0,i.jsxs)(o.kC,{css:{alignItems:"center",gap:"$xxxs"},children:[(0,i.jsx)(a.xv,{variant:"subline",color:"body",css:{textTransform:"uppercase"},children:"Your Charon client ENR"}),(0,i.jsx)(a.KZ,{content:'An ENR is an "Ethereum Node Record", and is used to identify your client to the other clients in the cluster."',children:(0,i.jsx)(a.xu,{css:{display:"flex"},children:(0,i.jsx)(a.by,{})})})]}),(0,i.jsx)(m.i,{control:$,name:"enr"})]}),(0,i.jsxs)(a.rU,{href:"https://docs.obol.tech/docs/next/int/faq/errors#enrs-keys",target:"_blank",children:["More on Ethereum Node Records ",(0,i.jsx)(a.ZJ,{})]})]}),(0,i.jsx)(w.T,{name:"multi_withdrawal",children:(null===J||void 0===J?void 0:J.recipients)&&(0,i.jsx)(a.W2,{className:"cluster-details",alignItems:"start",children:(0,i.jsx)(o.VL,{operators:U.validators.map((function(e){return{address:e.withdrawal_address}})),currentAccount:r,header:"Validator Withdrawal Contract Addresses"})})}),(!(0,w.c)("multi_withdrawal")||!(null===J||void 0===J?void 0:J.recipients))&&(0,i.jsxs)(a.W2,{className:"withdrawal-section",css:{gap:"$sm"},alignItems:"start",children:[(0,i.jsxs)(o.kC,{direction:"column",className:"single-address-section",css:{gap:"$sm"},children:[(0,i.jsx)(a.xv,{variant:"h4",children:"Single Address"}),(0,i.jsx)(a.xv,{color:"body",variant:"body",children:"The withdrawal address or contract will receive 100%"}),(0,i.jsx)(a.nv,{color:"obolGreen",readOnly:!0,value:U.withdrawal_address||(null===V||void 0===V?void 0:V.withdrawal_address)})]}),(0,i.jsxs)(o.kC,{direction:"column",className:"fee-recipient-address-section",css:{gap:"$sm"},children:[(0,i.jsx)(a.xv,{variant:"h4",children:"Fee Recipient"}),(0,i.jsx)(a.xv,{color:"body",variant:"body",children:"Address to receive transaction fees from block proposals."}),(0,i.jsx)(a.nv,{color:"obolGreen",readOnly:!0,value:U.fee_recipient_address||(null===V||void 0===V?void 0:V.fee_recipient_address)})]})]}),(0,i.jsxs)(a.W2,{className:"confirm-details-section",alignItems:"start",css:{gap:"$lg"},children:[(0,i.jsx)(a.xv,{variant:"h4",children:"Confirm Details"}),(0,i.jsxs)(o.kC,{css:{gap:"$xs",width:"$full"},children:[(0,i.jsx)(a.xu,{children:(0,i.jsx)(a.XZ,{checked:W,onCheckedChange:function(){return E(!W)}})}),(0,i.jsx)(a.xv,{variant:"body",children:"You will be prompted to sign a message with your wallet. This signature is attesting to the fact that:"})]}),(0,i.jsx)(a.sQ,{heading:"You have confirmed the withdrawal address for the validators to be created is correct. If this address is a contract, you have confirmed the contract implementation is correct. If this address is an externally-owned account, you have confirmed that the EOA custody is secure. This address is where the principal and rewards for all created validators will be credited to and the address cannot be modified."}),(0,i.jsx)(a.sQ,{heading:"You have submitted your charon node's Ethereum Node Record (ENR) correctly. This signature is the authorisation of this charon client to act on your behalf."}),P&&(0,i.jsxs)(a.mh,{css:{backgroundColor:"$test"},children:[(0,i.jsx)(a.xu,{children:(0,i.jsx)(a.zM,{size:"lg",color:"body"})}),(0,i.jsx)(o.kC,{direction:"column",css:{gap:"$sm"},children:(0,i.jsx)(o.kC,{direction:"column",css:{gap:"$xs"},children:(0,i.jsx)(a.xv,{color:"textLight",children:P})})})]}),(0,i.jsxs)(o.kC,{direction:"column",children:[(0,i.jsx)(a.zx,{color:"primary",type:"submit",css:{"& div":{m:0}},disabled:!N||!I||!r||!W,children:(0,i.jsxs)(i.Fragment,{children:[O&&(0,i.jsx)(a.yC,{}),"Confirm and Sign"]})}),!r&&(0,i.jsx)(a.xv,{variant:"metadata",color:"test",children:"Please connect your wallet"})]})]})]})]})})]})},S=k;k.layout="OperatorProgressTrackerLayout"}},function(e){e.O(0,[774,888,179],(function(){return r=67333,e(e.s=r);var r}));var r=e.O();_N_E=r}]);